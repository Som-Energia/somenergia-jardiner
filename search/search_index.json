{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Sobre Som Energia Jardiner","text":"<p>Documentaci\u00f3 per eines desenvolupades en el context del projecte <code>somenergia-jardiner</code> de Som Energia.</p>"},{"location":"#repositoris","title":"Repositoris","text":"<ul> <li>Jardiner</li> <li>Mirror a Github</li> <li>Plant reader per la lectura de la API del prove\u00efdor de dades.</li> <li>Plantmonitor Legacy project per a les tasques d'ingesta de solargis i meteologica.</li> </ul>"},{"location":"#accessos-directes","title":"Accessos directes","text":"<ul> <li>Alta d'una nova planta</li> </ul>"},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/","title":"Com processem les alarmes en DBT?","text":""},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>Alarmes decomptadors venen en batches que poden venir molt tard.</p>"},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>Necessitem un hist\u00f2ric d'alarmes</li> <li>Cal suportar un batch arbitrari (rebre les lectures de les \u00fatlimes 24h o dels \u00faltims 3 mesos)</li> <li>Alarma \u00e9s pr\u00f2pia d'un punt en el temps i un aparell o un conjunt (planta)</li> </ul> <p>unsupported ara mateix</p> <ul> <li>No suportarem out of the box updates de les lectures (el plantmonitor ni ho considera, ara per ara)</li> </ul>"},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/#considered-options","title":"Considered Options","text":"<ol> <li>Calcular l'alarma de les \u00faltimes N hores (rang definit per l'alarma)</li> <li>Calcular per cada row si en aquell moment hi havia alarma o no</li> </ol> <p>pseudocode-ish idea: Energy last 24h is 0 -&gt; alarm</p> <p>select sum(energy) from     select lag(energy, partition by device order by date desc) from (select * from registry where device1 and date &gt; last_date_1 or device2 and date &gt; last_date_2) group</p> <p>on last_date = select max(date) from processed group by device</p> <ol> <li>Union amb jinja de 2</li> </ol> <p>select '' as lectura_date, '' as device, '' as alarm</p> <p>calculated_alarms:</p> <p>{% foreach row in meters%} UNION opci\u00f3 2 select max(energy) &gt; 0 from registry where  device = row['device'] and  date &gt; row['date'] - 24h</p> <p>select from {{ this }} order by date desc limit 1</p> <p>materialitzada: select max(date) from calculated_alarms group by device</p> <ol> <li>incremental de dbt + foreach device</li> </ol> <p>{{ config(materialized='incremental') }}</p> <p>select date, max(energy) &gt; 0 from registry --&gt; caldr\u00e0 un lag o algo</p> <p>from raw_app_data.events</p> <p>{% if is_incremental() %}   where event_time &gt; (select max(event_time) from {{ this }})</p> <p>quan entri un device nou hem de comprovar que where event_time &gt; NULL torna totsels resultats</p> <ul> <li>without lag: left join with itself on row_number()-24 &lt; row_number() &lt; row_number()</li> </ul> <p>source</p>"},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: triem l'opci\u00f3 2. per suportar calcular alarmes en el passat</p>"},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/#positive-consequences","title":"Positive Consequences","text":"<ul> <li>Suporta la c\u00e0rrega de batches arbitraris</li> <li>Mant\u00e9 un hist\u00f2ric d'alarma</li> </ul>"},{"location":"adr/2022-10-11-dbt_workflow_meter_alarms/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>Requereix materialitzar una taula amb la \u00faltima lectura processada (o tenir un staging on s'inserten les noves)</li> <li>Incrementa la complexitat de la query SQL</li> </ul>"},{"location":"adr/2022-10-14-meter_alarm_logic/","title":"Meter alarm logic","text":"<ul> <li>Status: Unknown</li> <li>Deciders: [list everyone involved in the decision] </li> <li>Date: [YYYY-MM-DD when the decision was last updated] </li> </ul> <p>Technical Story: [description | ticket/issue URL] </p>"},{"location":"adr/2022-10-14-meter_alarm_logic/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>Les alarmes de comptadors s'han de notificar.</p>"},{"location":"adr/2022-10-14-meter_alarm_logic/#decision-drivers","title":"Decision Drivers","text":"<p>coberts: * moxa ens arriben les lectures cada 24h * hi ha comptadors sense lectures durant temps * la notificaci\u00f3 diuen que la volen un cop al dia al llegir del moxa</p> <ul> <li>tamb\u00e9 volem notificacions de quant s'ha arreglat una planta que estava en alarma</li> </ul>"},{"location":"adr/2022-10-14-meter_alarm_logic/#considered-options","title":"Considered Options","text":"<ul> <li>fer un post per cada planta un cop cada 24h amb el resum de l'estat de les alarmes [OK|NOK]</li> <li>tenir una taula de canvis d'estat i notificar-la</li> <li>guardar la taula i fer un diff al dia seguent</li> </ul>"},{"location":"adr/2022-10-14-meter_alarm_logic/#decision-outcome","title":"Decision Outcome","text":""},{"location":"adr/2022-10-14-meter_alarm_logic/#positive-consequences","title":"Positive Consequences","text":""},{"location":"adr/2022-10-14-meter_alarm_logic/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>rebran un e-mail cada dia si hi ha un comptador que no va o reporta 0 --&gt; poden desubstriure's de l'alarma</li> </ul> <p>podem</p>"},{"location":"adr/2022-10-14-meter_alarm_logic/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/2022-10-14-meter_alarm_logic/#guardar-taula-i-fer-diff","title":"guardar taula i fer diff","text":"<ul> <li>guardar la taula i fer un diff al dia seguent</li> </ul> <p>ho farem amb un pandas/sql f\u00e0cil per no posar dbt a producci\u00f3 encara</p> <p>--&gt; ho acabar\u00e0 fent dbt a mig termini</p>"},{"location":"adr/2022-10-14-meter_alarm_logic/#links","title":"Links","text":"<ul> <li>[Link type] [Link to ADR] </li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-14-spines/","title":"Spines","text":"<ul> <li>Status: Unknown</li> <li>Deciders: [list everyone involved in the decision] </li> <li>Date: [YYYY-MM-DD when the decision was last updated] </li> </ul> <p>Technical Story: [description | ticket/issue URL] </p>"},{"location":"adr/2022-10-14-spines/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>[Podem fer un spine amb un left join sense condici\u00f3 contra plant i meter per tenir el carret buit i despr\u00e9s fer un left join amb les lectures</p> <p>dbt_spine left join plant left join meter on plant.id = meter.plant</p>"},{"location":"adr/2022-10-14-spines/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>[driver 1, e.g., a force, facing concern, \u2026]</li> <li>[driver 2, e.g., a force, facing concern, \u2026]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-14-spines/#considered-options","title":"Considered Options","text":"<ul> <li>[option 1]</li> <li>[option 2]</li> <li>[option 3]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-14-spines/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: \"[option 1]\", because [justification. e.g., only option, which meets k.o. criterion decision driver | which resolves force force | \u2026 | comes out best (see below)].</p>"},{"location":"adr/2022-10-14-spines/#positive-consequences","title":"Positive Consequences","text":"<ul> <li>[e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2022-10-14-spines/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>[e.g., compromising quality attribute, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2022-10-14-spines/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/2022-10-14-spines/#option-1","title":"[option 1]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-14-spines/#option-2","title":"[option 2]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-14-spines/#option-3","title":"[option 3]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-14-spines/#links","title":"Links","text":"<ul> <li>[Link type] [Link to ADR] </li> <li>\u2026 </li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/","title":"Real time alarms","text":"<ul> <li>Status: Unknown</li> <li>Deciders: [list everyone involved in the decision] </li> <li>Date: [YYYY-MM-DD when the decision was last updated] </li> </ul> <p>Technical Story: [description | ticket/issue URL] </p>"},{"location":"adr/2022-10-26-real-time_alarms/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>Necessitem alertes d'incid\u00e8ncies dels diferents dispositius de les plantes. Cada dispositiu t\u00e9 especificitats: granularitat temporal de les lectures, lag natural en al c\u00e0rrega de lectures i casu\u00edstiques concretes que es consideren errors.</p> <p>Dispositius: - Meter ip Granularitat lectura: 1 hora Cada quan arriben les lectures: 20 min (per\u00f2 ERP sincronitza cada 2 hores) Valors historics updatable: No actualment (a l'erp s\u00ed) Poden apar\u00e8ixer lectures antigues: No actualment (a l'erp s\u00ed)</p> <ul> <li> <p>Meter moxa Granularitat lectura: 1 hora Cada quan arriben les lectures: 20 min (per\u00f2 ERP sincronitza cada 24 hores) Batch: 24h Valors historics updatable: No actualment (a l'erp s\u00ed) Poden apar\u00e8ixer lectures antigues: No actualment (a l'erp s\u00ed)</p> </li> <li> <p>Inverter Granularitat lectura: 5 minuts Cada quan arriben les lectures: 5 minuts Valors historics updatable: No Poden apar\u00e8ixer lectures antigues: Rarament</p> </li> <li> <p>String Granularitat lectura: 5 minuts Cada quan arriben les lectures: 5 minuts Valors historics updatable: No Poden apar\u00e8ixer lectures antigues: Rarament</p> </li> <li> <p>Plant</p> </li> </ul> <p>Casu\u00edstica: Meter \u00e9s variable enla cad\u00e8ncia d'enviar lectures (sovint tarda a reconnectar)</p> <ul> <li>Meter que no conecta Granularitat lectura: 1 hora Cada quan arriben les lectures: Valors historics updatable: No Poden apar\u00e8ixer lectures antigues: No</li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>Velocitat d'execuci\u00f3 si cal exeutar-ho sovint</li> <li>Poder recalcular les alarmes hist\u00f2riques en el futur</li> <li>Necessitat de notificar a diversos agents diverses alarmes</li> <li>Real-time \u00e9s necessari en algunes alarmes per evitar p\u00e8rdues econ\u00f3miques</li> <li>Necessitem un hist\u00f2ric</li> <li>Hauriem de tenir un from to de duraci\u00f3 de les alarmes (tot i que conf\u00f3n una mica a projectes)</li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/#considered-options","title":"Considered Options","text":"<ul> <li>HI - Calcular realtime a partir de l'hist\u00f2ric individual de cada alarma</li> <li>RT - Calcular una taula real-time i una hist\u00f2rica m\u00e9s lenta</li> <li>~~RH - Calcular la real-time i guardar-ho com a hist\u00f2ric~~</li> <li>~~ST - Trobar la manera de fer stream enlloc de batch~~</li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/#decision-outcome","title":"Decision Outcome","text":"<p>Hem decidit atacar la opci\u00f3 HI i veure si podem reduir a 5 minuts d'execuci\u00f3 amb incremental. Probablement no ser\u00e0 possible i necessitarem un fast-track (opci\u00f3 RL) per les alertes real-time.24h</p> <p>Aquest fast track s'executar\u00e0 cincminutalment o podem veure si es podria fer en streaming EL -&gt; T -&gt; N(otificaci\u00f3) Ser\u00e0 exclusiu per alertes i amb poca consolidaci\u00f3 a base de dades i no revisitar\u00e0 el passat. Nom\u00e9s NOW()-ish.</p>"},{"location":"adr/2022-10-26-real-time_alarms/#positive-consequences","title":"Positive Consequences","text":"<ul> <li>[e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>[e.g., compromising quality attribute, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/2022-10-26-real-time_alarms/#hi-calcular-la-taula-historica","title":"HI - Calcular la taula hist\u00f2rica","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li> <ul> <li>Una \u00fanica l\u00f2gica si no tenim incremental</li> </ul> </li> <li> <ul> <li>No hem fet incremental amb DBT mai encara</li> </ul> </li> <li> <ul> <li>l'incremental pot reescriure dels dos darrers dies</li> </ul> </li> <li> <ul> <li>pots regenerar la taula sempre</li> </ul> </li> <li> <ul> <li>fa m\u00e9s complexe les alarmes individuals (over partitions)</li> </ul> </li> </ul> <pre><code>DAG:\n(production_inverter) -&gt; (alarm) -&gt; (alrm2)\n\nwith ( Taula production_inverter (registry gapfilled, clean, alarms )) as foo\n\ntime     | inverter_id | energy | n_readings | alarm_no_reading | alarm_zero_daylight\n10:00:00      16           34          1            FALSE               FALSE\n09:55:00      16         0/NULL        0            TRUE                NULL\n09:50:00      16            0          1            FALSE               TRUE\n\nselect last row of foo where alarm = TRUE\n</code></pre>"},{"location":"adr/2022-10-26-real-time_alarms/#rt-calcular-una-taula-real-time-i-una-historica-mes-lenta","title":"RT - Calcular una taula real-time i una hist\u00f2rica m\u00e9s lenta","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li> <ul> <li>Logica m\u00e9s senzilla i r\u00e0pida que podem executar m\u00e9s sovint a airflow</li> </ul> </li> <li> <ul> <li>Permet amb un date_trunc() sobre les lectures fer l'agregaci\u00f3 i no cal rolling</li> </ul> </li> <li> <ul> <li>Igualment s'ha d'escriure la l\u00f2gica HI per tenir l'hist\u00f2ric correcte</li> </ul> </li> <li> <ul> <li>Podries tenir la taula d'estat actual m\u00e9s f\u00e0cilment</li> </ul> </li> <li> <ul> <li>La unificada s'hauria de fer unint la taula hist\u00f2rica amb la real-time</li> </ul> </li> <li> <ul> <li>requereix molt lag en escriure la hist\u00f2rica, o posar-hi la l\u00f2gica que necessites igualment a la opci\u00f3 HI</li> </ul> </li> <li> <ul> <li>Pot generar incongru\u00e8ncies entre el Real-Time (alarmed) que no surtin a l'hist\u00f2ric</li> </ul> </li> <li> <ul> <li>A projectes no li agrada tenir una taula estat actual i hist\u00f2ric separat</li> </ul> </li> </ul> <p>RT:</p> <p>real-time, per les alarmes que necessiten notificaci\u00f3 immediata, i per cada tipus d'alarma <pre><code>with foo as (\nselect\n    count(energy),\n    max(energy)\nfrom registry\nwhere NOW() - device.alarm_offset &lt; time\ngroup by device\n)\nselect\n now() as time,\n count = 0 as no_reading_alarm,\n max = 0 as no_energy_alarm\nfrom foo\n</code></pre> notify OK/KO en aquella execuci\u00f3 fent un diff de la taula anterior com ara</p> <p>hist\u00f2ric: com tenim ara, al final del dia o d'una setmana, re-calcular les alarmes hist\u00f2ricament</p>"},{"location":"adr/2022-10-26-real-time_alarms/#st-trobar-la-manera-de-fer-stream-enlloc-de-batch","title":"ST- Trobar la manera de fer stream enlloc de batch","text":"<ul> <li>Dolent perqu\u00e8 no podem regenerar-ho a posteriori</li> </ul>"},{"location":"adr/2022-10-26-real-time_alarms/#links","title":"Links","text":"<ul> <li>[Link type] [Link to ADR] </li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/","title":"Pipeline de dades revisited","text":"<ul> <li>Status: proposed</li> <li>Deciders:</li> <li>Date:</li> </ul> <p>Technical Story:</p> <p>Com ser\u00e0 la obt? horaria calculada un cop cada hora? I quan passem a comptadors 15-minutals, segurem amb dbt run 15-minutal? Quina frescor de les dades cal? --&gt; posem-ho a un adr diferent</p>"},{"location":"adr/2023-06-13-obt_plantes/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>Si les dades cincminutals s\u00f3n horaries, la obt de tots els indicadors tamb\u00e9?</p> <p>Passarem a comptadors 15minutals en algun moment proper.</p>"},{"location":"adr/2023-06-13-obt_plantes/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>\u00das real de la obt</li> <li>Frescor necess\u00e0ria</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#considered-options","title":"Considered Options","text":"<ul> <li>[option 1]</li> <li>[option 2]</li> <li>[option 3]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: \"[option 1]\", because [justification. e.g., only option, which meets k.o. criterion decision driver | which resolves force force | \u2026 | comes out best (see below)].</p>"},{"location":"adr/2023-06-13-obt_plantes/#positive-consequences","title":"Positive Consequences","text":"<ul> <li>[e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>[e.g., compromising quality attribute, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/2023-06-13-obt_plantes/#option-1","title":"[option 1]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#option-2","title":"[option 2]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#option-3","title":"[option 3]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-obt_plantes/#links","title":"Links","text":"<ul> <li>[Link type] [Link to ADR] </li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/","title":"Pipeline de dades revisited","text":"<ul> <li>Status: proposed</li> <li>Deciders: Diego, Roger, Pol</li> <li>Date: 2023-06-12</li> </ul> <p>Technical Story:</p> <p>https://trello.com/c/rmCTOJrH/205-decidir-com-farem-lobt-i-el-cincminutal-r%C3%A0pid</p> <p>Passem a una macrotaula de dades llargues clau-valor per a les dades cincminutals?</p> <p>Com ser\u00e0 la obt? horaria calculada un cop cada hora? I quan passem a comptadors 15-minutals, segurem amb dbt run 15-minutal? Quina frescor de les dades cal? --&gt; posem la discussi\u00f3 de la obt a un adr diferent</p>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>Ara que sabem molt m\u00e9s dbt i que incorporarem un prove\u00efdor de dades cincminutals amb dades llargues que deprecar\u00e0 l'esquema antic, ens plantegem si haur\u00edem de basar en una macrotaula de dades llargues per les dades cincminutals.</p>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>\u00das real del cinc-minutal</li> <li>Frescor necess\u00e0ria</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#considered-options","title":"Considered Options","text":"<ol> <li>normalitzar dset i fer un multisource normalitzat com est\u00e0 ara</li> <li>desnormalitzar lo que hi ha ara i fer un multisource com ens envia dset</li> <li>fer una pseudo-obt llarga a partir de dset i fer le multisource al mart</li> </ol>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: opci\u00f3 3</p> <ul> <li>[e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>[e.g., compromising quality attribute, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/2023-06-13-pipeline_dades_llargues/#option-1","title":"[option 1]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#option-2","title":"[option 2]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#option-3","title":"[option 3]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-06-13-pipeline_dades_llargues/#links","title":"Links","text":"<ul> <li>[Link type] [Link to ADR] </li> <li>\u2026 numbers of links can vary --&gt;</li> </ul>"},{"location":"adr/2023-09-12-redash_vs_superset/","title":"Pipeline de dades revisited","text":"<ul> <li>Status: proposed</li> <li>Deciders: Dades</li> <li>Date: 2023-09-12</li> </ul>"},{"location":"adr/2023-09-12-redash_vs_superset/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>En el seu moment vam triar redash perqu\u00e8 podia tenir apis com a sources i el dev \u00e9s molt m\u00e9s c\u00f2mode perqu\u00e8 no est\u00e0 tant layeritzat (dataset/query - chart - dashboard).</p> <p>A la pr\u00e0ctica no hem fet servir mai la lectura directa de les apis perqu\u00e8 les aut\u00e8ntificacions no estaven suportades, ens agradava tenir una c\u00f2pia, t'obligava a treballar en queries de l'sqlite de redash.</p> <p>A m\u00e9s a m\u00e9s, redash delega la gesti\u00f3 d'usuaris a la db, cosa que implica que no pots limitar que un usuari pugui veure uns valors d'una query i no uns altres, per exemple filtrar per plantes la producci\u00f3, els permisos es fan a nivell de db.</p> <p>La macrofase de plantmonitor i l'evoluci\u00f3 de l'equip de dades cap a superset amb els altres equips ens porta a replantejar-nos-ho.</p> <p>Iniciem un spike de superset per a fer els nous dashboards.</p>"},{"location":"adr/2023-09-12-redash_vs_superset/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>\u00das real del cinc-minutal</li> <li>Frescor necess\u00e0ria</li> <li>\u2026 </li> </ul>"},{"location":"adr/2023-09-12-redash_vs_superset/#considered-options","title":"Considered Options","text":"<ol> <li>superset</li> <li>redash</li> <li>metabase -- en Diego comenta que en la versi\u00f3 free no tens la capa sem\u00e0ntica</li> </ol>"},{"location":"adr/2023-09-12-redash_vs_superset/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: ?</p>"},{"location":"adr/2023-09-12-redash_vs_superset/#positive-consequences","title":"Positive Consequences","text":"<ul> <li>[e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2023-09-12-redash_vs_superset/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>[e.g., compromising quality attribute, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/2023-09-12-redash_vs_superset/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/2023-09-12-redash_vs_superset/#redash","title":"redash","text":"<p>\ud83d\udc4d</p> <p>mustache</p> <p>definir parametres a nivell de default de charts, de chart especific o dashboard</p> <p>\ud83d\udc4e</p> <p>no apte per heavy duty (cache regular)</p>"},{"location":"adr/2023-09-12-redash_vs_superset/#superset","title":"superset","text":"<p>\ud83d\udc4d</p> <p>cohesi\u00f3 cooperativa -- tota la cooperativa fa servir superset</p> <p>\ud83d\udc4e</p> <p>No pots fixar filtres a nivell de chart al dashboard, cal fer-ne una c\u00f2pia. Implica que si volem canviar com s'ensenya un chart de planta, els haurem de canviar tots un a un.</p> <p>El jinja \u00e9s funky. No \u00e9s clar com fer servir el \"filter_values\" a dins d'una query. Les queries din\u00e0miques s\u00f3n molt menys directes de fer que al redash.</p>"},{"location":"adr/template/","title":"Template","text":"<p>^-- [short title of solved problem and solution]</p> <ul> <li>Status: [proposed | rejected | accepted | deprecated | \u2026 | superseded by <code>[ADR-0005](0005-example.md)]</code> </li> <li>Deciders: [list everyone involved in the decision] </li> <li>Date: [YYYY-MM-DD when the decision was last updated] </li> </ul> <p>Technical Story: [description | ticket/issue URL] </p>"},{"location":"adr/template/#context-and-problem-statement","title":"Context and Problem Statement","text":"<p>[Describe the context and problem statement, e.g., in free form using two to three sentences. You may want to articulate the problem in form of a question.]</p>"},{"location":"adr/template/#decision-drivers","title":"Decision Drivers","text":"<ul> <li>[driver 1, e.g., a force, facing concern, \u2026]</li> <li>[driver 2, e.g., a force, facing concern, \u2026]</li> <li>\u2026 </li> </ul>"},{"location":"adr/template/#considered-options","title":"Considered Options","text":"<ul> <li>[option 1]</li> <li>[option 2]</li> <li>[option 3]</li> <li>\u2026 </li> </ul>"},{"location":"adr/template/#decision-outcome","title":"Decision Outcome","text":"<p>Chosen option: \"[option 1]\", because [justification. e.g., only option, which meets k.o. criterion decision driver | which resolves force force | \u2026 | comes out best (see below)].</p>"},{"location":"adr/template/#positive-consequences","title":"Positive Consequences","text":"<ul> <li>[e.g., improvement of quality attribute satisfaction, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/template/#negative-consequences","title":"Negative Consequences","text":"<ul> <li>[e.g., compromising quality attribute, follow-up decisions required, \u2026]</li> <li>\u2026</li> </ul>"},{"location":"adr/template/#pros-and-cons-of-the-options","title":"Pros and Cons of the Options","text":""},{"location":"adr/template/#option-1","title":"[option 1]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/template/#option-2","title":"[option 2]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/template/#option-3","title":"[option 3]","text":"<p>[example | description | pointer to more information | \u2026] </p> <ul> <li>Good, because [argument a]</li> <li>Good, because [argument b]</li> <li>Bad, because [argument c]</li> <li>\u2026 </li> </ul>"},{"location":"adr/template/#links","title":"Links","text":"<ul> <li>[Link type] [Link to ADR] </li> <li>\u2026 </li> </ul>"},{"location":"deprecated/TODOs/","title":"Views de plantmonitor a migrar a dbt","text":"<p>~ marca les que segurament no cal fer, al gust</p> <pre><code>view_availability.sql\n~view_q_hourly_debug.sql~\nview_q_monthly.sql\n~view_cos_phi_hourly_debug.sql~\nview_cos_phi_monthly.sql\nview_expected_power.sql\nview_hd_daily.sql\nview_ht_daily.sql\nview_ht_monthly.sql\nview_pr_hourly.sql\nview_target_energy.sql\n</code></pre>"},{"location":"deprecated/TODOs/#agregacions","title":"Agregacions","text":"<p>No cal fer-les perqu\u00e8 son agraupacions que segurament farem servir m\u00e8triques de dbt tipus:</p> <pre><code>view_inverter_energy_daily.sql\nview_inverter_energy_monthly.sql\nview_meter_export_energy_daily.sql\nview_meter_export_energy_monthly.sql\nview_average_yearly_production_plant.sql\nview_satellite_irradiation.sql\n</code></pre> <p>A m\u00e9s a m\u00e9s les m\u00e8triques de dbt resolen el problema seg\u00fcent:</p> <p>sum(a/x) -- horaria</p> <p>sum(a/x) + sum(b/y) ... mensual wrong</p> <p>sum((a+b+c)/(x+y+z)) -- mensual correct</p>"},{"location":"deprecated/TODOs/#views-per-limitar-lacces-a-la-info-dels-tecnics","title":"views per limitar l'acc\u00e9s a la info dels t\u00e8cnics","text":"<p>No cal fer-ho, limitarem l'acc\u00e9s a la wide table o farem servir els permisos del superset o ja veurem</p> <pre><code>view_plants_energes.sql\nview_plants_energetica.sql\nview_plants_ercam.sql\nview_plants_exiom.sql\nview_meterregistry_energetica.sql\nview_inverter_energy_daily_exiom.sql\nview_inverter_intensity_energes.sql\nview_inverter_intensity_ercam.sql\nview_inverter_intensity_exiom.sql\nview_inverter_power_energes.sql\nview_inverter_power_ercam.sql\nview_inverter_power_exiom.sql\nview_inverterregistry_energes.sql\nview_inverterregistry_ercam.sql\nview_inverterregistry_exiom.sql\nview_inverter_temperature_exiom.sql\nview_sensorirradiationregistry_energes.sql\nview_sensorirradiationregistry_ercam.sql\n</code></pre>"},{"location":"deprecated/TODOs/#no-shan-de-fer-obsoletes","title":"no s'han de fer (obsoletes)","text":"<pre><code>zero_inverter_power_at_daylight.sql\nzero_sonda_irradiation_at_daylight.sql\n</code></pre>"},{"location":"desenvolupadors/2023-02-08-novu_notifications/","title":"Novu helpers and quickstart","text":""},{"location":"desenvolupadors/2023-02-08-novu_notifications/#swagger-api","title":"Swagger API","text":"<p>Novu api</p>"},{"location":"desenvolupadors/2023-02-08-novu_notifications/#overview","title":"overview","text":"<p>Features in novu get to the api waaaay before the get to the UI, so keep it at hand since most of the changes (adding removing subscribers, topics, etc.) will be done via python, react or postman via api rest calls.</p>"},{"location":"desenvolupadors/2023-02-08-novu_notifications/#helpers","title":"helpers","text":"<p>We have a handful of scripts to interact with novu via airflow or command-line <code>scripts/notify_alert.py</code> and <code>scripts/novu_interface.py</code>.</p> <p>The <code>notify_alert</code> is ran by airflow to periodically check the alarm tables and trigger a notification on change.</p> <p><code>novu_interface</code> is more of a command-line util to do novu stuff manually, like adding subscribers or topics.</p> <p>For example, to add a topic of a plant we'd do</p> <pre><code>$ python -m scripts.novu_interface --help\n\nUsage: python -m scripts.novu_interface [OPTIONS] URL API_KEY TOPIC_KEY\n                                         TOPIC_NAME\n\nUsage: python -m scripts.novu_interface add-topic [OPTIONS] URL API_KEY\n                                                   TOPIC_KEY TOPIC_NAME\n\n\u256d\u2500 Arguments \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 *    url             TEXT  [default: None] [required]                  \u2502\n\u2502 *    api_key         TEXT  [default: None] [required]                  \u2502\n\u2502 *    topic_key       TEXT  [default: None] [required]                  \u2502\n\u2502 *    topic_name      TEXT  [default: None] [required]                  \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n\u256d\u2500 Options \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502 --help          Show this message and exit.                            \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n</code></pre> <p><pre><code>$ python -m scripts.novu_interface add-topic {novu_base_url} {api_key} {topic_key} {topic_name}\n$ python -m scripts.novu_interface add-topic http://moll3.somenergia.lan:3000/v1 {api_key} asomada-topic-1 \"asomada general topic\"\n</code></pre> and to get the topics</p> <pre><code>$ python -m scripts.novu_interface get-topic {novu_base_url} {api_key} {topic_key} {topic_name}\n\n2023-01-27 16:39:29,080 [INFO] {\"page\":0,\"totalCount\":1,\"pageSize\":10,\"data\":[\n    {\"_id\":\"63d3ef030d600f1df1a3829e\",\"_environmentId\":\"6349479f3043d373c3d5fc07\",\"_organizationId\":\"6349479f3043d373c3d5fc02\",\"key\":\"asomada-topic-1\",\"name\":\"asomada general topic\",\"subscribers\":[]}\n]}\n</code></pre> <p>Let's add some subcribers to it:</p> <pre><code>$ python -m scripts.novu_interface add-subscriber http://moll3.somenergia.lan:3000/v1 {api_key} pol_recipient\n$ python -m scripts.novu_interface add-topic-subscriber http://moll3.somenergia.lan:3000/v1 {api_key} asomada-topic-1 pol_recipient\n</code></pre>"},{"location":"desenvolupadors/2023-06-05-download_solargis_manually/","title":"Manually download a solargis reading","text":"<p>To download a specific day you just need to call</p> <pre><code>python -m scripts.solargis &lt;dbapi&gt; &lt;apikey&gt; 2023-05-13 2023-05-13 1 2 3 4\n 5 6 7 9 13 14 15 16 17 22 40\n</code></pre> <p>See <code>python -m scripts.solargis --help</code> for info on each parameter (essentially time range and plant id list) and the wiki or the pyxis server for credentials.</p> <p>Note that to download one day you have to put the same from and to date. The from is start day and to date is end day. The script DOES NOT check for duplicates. You'll have to clean up yourself using the query time if you made a mistake.</p>"},{"location":"desenvolupadors/2023-06-10-overview-devs/","title":"Overview for devs","text":""},{"location":"desenvolupadors/2023-06-10-overview-devs/#quickstart","title":"quickstart","text":"<p>To fully deploy the dbt models to the production schema you can do</p> <pre><code>dbt build -s tag:jardiner,tag:legacy --store-failures --full-refresh --target prod\n</code></pre> <p>You will need to have the <code>prod</code> profile in your <code>~/.dbt/profiles.yml</code> file.</p>"},{"location":"desenvolupadors/2023-06-10-overview-devs/#current-state-of-the-project","title":"Current State of the project","text":""},{"location":"desenvolupadors/2023-06-10-overview-devs/#pieces","title":"Pieces","text":""},{"location":"desenvolupadors/2023-06-10-overview-devs/#repos","title":"repos","text":"<p>Plantmonitor</p> <p>Fa d'ORM de les plantes, cont\u00e9 la api i \u00e9s codi de les raspberrypis. A m\u00e9s a m\u00e9s tamb\u00e9 t\u00e9 el codi d'ingesta d'apis de tercers.</p> <p>Warning</p> <p>La meitat del plantmonitor acabar\u00e0 deprecated pel prove\u00efdor de dades</p> <p>Plant Reader</p> <p>Lectura remota de les plantes. Actualment nom\u00e9s Asomada es llegeix remotament i es guarda a <code>plant_lake</code>.</p> <p>Acabar\u00e0 deprecated pel prove\u00efdor de dades.</p> <p>Actualment tamb\u00e9 allotja la lectura de la API del prove\u00efdor de dades.</p> <p>Jardiner</p> <p>dbt de les plantes. Actualment tot views.</p>"},{"location":"desenvolupadors/2023-06-10-overview-devs/#data-sources","title":"Data sources","text":"<ul> <li>rPIs</li> <li>plant_reader</li> <li>Irradiation satellite data provider (SAT)</li> <li>Meteo forecast provider (METEO)</li> <li>Plant data provider (PLANT)</li> <li>Price provider (Planned) (PRICE)</li> </ul>"},{"location":"desenvolupadors/2023-06-10-overview-devs/#visualization","title":"Visualization","text":"<ul> <li>redash</li> <li>novu notifications -&gt; helpscout/mail</li> <li>superset (other \u00e0mbits of the cooperative)</li> </ul>"},{"location":"desenvolupadors/2023-06-10-overview-devs/#project-tructure","title":"Project tructure","text":""},{"location":"desenvolupadors/2023-06-10-overview-devs/#actual","title":"Actual","text":"<pre><code>flowchart LR\n\ndw[db/plants]\n\nplants -- pull 5' \\n plant_reader/dags --&gt; lake[db/plant_lake]\nlake -- push 5' \\n airbyte --&gt; dw\n\nplants -- pull 5' \\n plantmonitor/main.py --&gt; rPIs -- push 5'  --&gt; dw\nplants -- pull 2h/12h \\n meter \\n ERP's import_tm_data_click.py --&gt; ERP -- pull 20'\u00ba\\n meter data --&gt; dw\nSAT -- pull daily\u00ba\\n irr/expected energy --&gt; dw\nMETEO &lt;-- pull daily\u00ba\\n meter data +  irr/kWh forecast --&gt; dw\nplants -- pull 15'\\n plant_reader/dags --&gt; PLANT -- pull 15'\\n devices data --&gt; db/plant_lake\n\ndw -- dbt views --&gt; prod --&gt; alarms\nprod --&gt; alerts\nprod --&gt; datasets</code></pre> <p>\u00ba: plantmonitor does it. Update rate defined at conf/startup_configuration.py and each task is run as a function.</p>"},{"location":"desenvolupadors/2023-06-10-overview-devs/#planned-scheme","title":"Planned scheme","text":"<pre><code>flowchart LR\n\ndw[db/plants]\n\nplants -- pull 2h/12h \\n meter \\n import_tm_data_click.py --&gt; ERP -- pull 20' \u00ba\\n meter data --&gt; dw\nSAT -- pull daily\\n irr/expected energy --&gt; dw\nMETEO &lt;-- pull daily\\n meter data +  irr/kWh forecast --&gt; dw\nplants -- pull 15' --&gt; PLANT -- pull 15'\\n devices data --&gt; dw\n\n\ndw -- dbt fast --&gt; fast[dbt_prod/fast_] --&gt; union\ndw -- dbt --&gt; obt --&gt; alarms\nobt --&gt; union\nunion -- notify.py --&gt; alerts\nobt --&gt; datasets</code></pre> <p>Despr\u00e9s de l'ADR d'estructura de pipeline</p> <p>See Roadmap</p>"},{"location":"desenvolupadors/2023-07-10-dbt_cmds_utils/","title":"dbt commands","text":"<ol> <li>Generar i servir la documentaci\u00f3 per a poder veure el directed graph.</li> </ol> <pre><code>$ dbt docs generate --project-dir dbt_jardiner --target pre\n\n$ dbt docs serve --project-dir dbt_jardiner --target pre --port 8010\n</code></pre> <ol> <li>Pujar tots els CSVs de seeds</li> </ol> <pre><code>dbt seed --project-dir dbt_jardiner\n</code></pre> <ol> <li>Podem passar variables per command line (en comptes de definir-les a dbt_project.yml i fer-les accesibles per diferents resources):</li> </ol> <p><pre><code>dbt run --vars '{\"variable\":\"value\"}'\n</code></pre> Per fer testing amb un csv determinat:</p> <pre><code>dbt run --project-dir project_x --target testing --vars '{\"test_sample\":\"nom_del_csv\"}' -m model_x\n</code></pre>"},{"location":"desenvolupadors/2023-07-13-codi_reciclable/","title":"Reusuable sqls","text":""},{"location":"desenvolupadors/2023-07-13-codi_reciclable/#dbt-sql-for-rolling-window","title":"dbt sql for rolling window","text":"<pre><code>{%- set plant_alarm_ranges = dbt_utils.get_query_results_as_dict(ref('plant_alarm_ranges')) -%}\n\n{% for plant in plant_alarm_ranges %}\n\n  {% if var('plants_code') == 'SomEnergia_Riudarenes_ZE' %}\n      {%- set time_to_sum = '1 hour' -%}\n  {% elif var('plants_code') == 'SomEnergia_Matallana' %}\n      {%- set time_to_sum = '4 hour' -%}\n  {% else %}\n          {{ ref('accounts') }}   accounts\n  {% endif %}\n\n  SELECT\n      *,\n      SUM(export_energy_wh) OVER (\n          PARTITION BY plant_name\n          ORDER BY \"time\"\n          RANGE BETWEEN interval {{time_to_sum}} PRECEDING AND CURRENT ROW\n      ) as export_energy_wh_sum\n  FROM (\n    select * from {{ref('meter_registry_cleaned')}} where codename = {{plants_code}}\n  ) as meter_registry_cleaned_current_plant\n  UNION ALL\n\n{% endfor %}\n</code></pre>"},{"location":"desenvolupadors/2023-08-28-alta_planta/","title":"Context","text":"<p>Tenim un pipe de transformaci\u00f3 de dades que acaba en una serie de dashboards de superset que mostra dades de plantes des de el pipe de transformaci\u00f3 de dades arribant del nostre prove\u00efdor de dades.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#protocol-dalta-duna-planta-fotovoltaica","title":"Protocol d'alta d'una planta fotovoltaica","text":"<p>Per afegir una nova planta a la visualitzaci\u00f3, cal seguir un protocol documentat al Formulari d\u2019inscripci\u00f3 de noves plantes a Superset</p> <p>El equip de gestio d'actius ha d'omplir aquest formulari amb les dades de la planta i ens ho han de comunicar per a que puguem seguir amb el proc\u00e9s nosaltres.</p> <p>Obres en curs amb jardiner-admin</p> <p>Aquesta tasca est\u00e0 en proc\u00e9s de ser portada al jardiner-admin. Per tant, aquest protocol pot canviar en el futur.</p> <p>Necessites permisos d'administrador</p> <p>Aquesta tasca \u00e9s per a desenvolupadors que treballen amb el pipe de transformaci\u00f3 de dades. Si no ets un desenvolupador, no cal que facis aquesta tasca.</p> <p>Aqui sota ens dediquem a documentar t\u00e9cnicament els passos a seguir des de la perspectiva de desenvolupament.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#checklist-general-per-it","title":"Checklist general per IT","text":"<ul> <li> Tenir acc\u00e9s als seg\u00fcents documents<ul> <li> Mapeig de senyals</li> <li> Dades fixes de planta</li> <li> Info api solargis</li> <li> Rendiment de planta</li> <li> Producci\u00f3 actual de planta</li> </ul> </li> <li> Omplir dades al excel de mapeigs d\u2019airbyte</li> <li> Afegir planta segons l\u2019estructura de plantmonitor</li> <li> Dades de Solargis de planta nova s\u00f3n al script a plantmonitor</li> <li> Dades apareixen al superset correctament</li> </ul>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#descripcio-de-dades","title":"Descripci\u00f3 de Dades","text":""},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-mapeig-de-senyals","title":"Mapeig de senyals de Planta","text":"<p>Per cada planta, GdA genera fitxers amb informaci\u00f3 de la planta per la seva gesti\u00f3. Aquests fitxers contenen informaci\u00f3 de senyals, aparells, plantes, etc. per\u00f2 sense el context del pipe de Jardiner. Com IT, portem aquesta informaci\u00f3 al fitxer de mapeig de senyals per a que el pipe de Jardiner pugui fer integrar les dades de la planta.</p> <p>Un exemple d'aquest fitxer pot ser aquest.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-dades-fixes-de-planta","title":"Dades fixes de planta","text":"<p>Aquest fitxer cont\u00e9 dades fixes de la planta, com ara la pot\u00e8ncia de la planta, la seva ubicaci\u00f3, etc. Es trova a google drive i es transforma amb airbyte aqui</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-info-api-solargis","title":"Info API SolarGIS","text":"<p>GdA ha de crear una entrada per la planta nova al fitxer excel per aix\u00f2</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-rendiment-de-planta","title":"Rendiment de planta","text":"<p>T\u00e9 un nom tipus <code>\"C\u00e0lcul Rendiment de Planta &lt;nom planta&gt;\"</code>. El podeu buscar al cercador de drive.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-produccio-actual-de-planta","title":"Objectius de producci\u00f3 de planta","text":"<p>Es troba al fitxer de google sheets aqui i es transforma amb airbyte aqui.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-unificacio-noms-projectes-generacio","title":"Unificaci\u00f3 Noms Projectes Generaci\u00f3","text":"<p>Cont\u00e9 els llistat de noms unificats en un sol fitxer. Ves a Unificaci\u00f3 Noms Projectes Generaci\u00f3.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#fitxer-modelos-contadores-inversores-scadas","title":"Modelos contadores_inversores_SCADAS","text":"<p>Modelos contadores_inversores_SCADAS</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#descripcio-de-tasques","title":"Descripci\u00f3 de tasques","text":""},{"location":"desenvolupadors/2023-08-28-alta_planta/#afegir-mapeig-airbyte","title":"Afegir dades al mapeig d'airbyte","text":"<p>Tenim un document on consolidem relacions entre UUIDs de senyals, aparells i plantes que inserim amb airbyte</p> <p>Aquest mapeig es una traducci\u00f3 del fitxer de mapeigs.</p> <p>Un cop heu acabat de fer el mapeig, cal engegar la tasca de sync de l'airbyte d'uuids per que les dades arribin a la base de dades. Heu de tenir especial cura d'omplir les columnes <code>updated_at</code> i aquelles que posen UUIDs, ja que amb elles se creuen les dades dins del pipe.</p> <p><code>update_at</code> s'actualitza automagicament</p> <p>Al fitxer de google sheets hi ha un script que actualitza la columna <code>updated_at</code> quan hi ha hagut un canvi a nivell de fila. Es molt limitat i heu de supervisar que s'ha actualitzat correctament, ja que de vegades google sheets no ho fa. Podeu mirar a <code>Extensions &gt; Apps Script</code> per veure el codi.</p> <p>UUID s\u00f3n versi\u00f3 4</p> <p>Els senyals porten UUID4 (han de ser versio 4) \u00fanics al mapeig de la planta indicada. Es poden generar UUID4 amb https://www.uuidgenerator.net/ O ben v\u00e9 amb un script de python que podeu afegir a <code>~/.bash_aliases</code>:</p> <pre><code>#\u00b7function\u00b7to\u00b7genenerate\u00b7random\u00b7uuid4\u00b7using\u00b7python$\nfunction pyuuid4() {\npython -c \"import uuid$\nfor _ in range(${N:-1}):\n    print(uuid.uuid4())\" ; }\n</code></pre> <p>i el podeu executar amb <code>N=&lt;n&gt; pyuuid4</code> per a generar <code>n</code> UUID4.</p> <pre><code>$ N=10 pyuuid4\nbf98707e-688c-471c-8700-9ffeaf436531\n8f6bfcc0-48bf-4b7c-895f-0b2efa37dd63\nee5dcfd1-80ba-48fb-800d-5bc8c04d217f\nd32b0a23-c479-4ae9-bb54-43390fedf8e4\neced945e-7a91-4451-bbd5-974a82c9c0d4\nfbacbf3d-23f6-4361-b5ec-b48b390d9c09\nb9c4ea66-672e-4dca-ad08-fddacdfb3627\nae3e242e-9a57-4359-a72b-313a72b48348\n9e11a595-c32c-42e1-8549-a5161c0ea624\n172061ed-96b4-4aa3-b5bd-0c66e850383b\n</code></pre>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#afegir-meteologica-plantmonitor","title":"Afegir planta per <code>meteologica</code> amb <code>plantmonitor</code>","text":"<p>Qu\u00e8 \u00e9s <code>meteologica</code>?</p> <p><code>meteologica</code> \u00e9s un servei que ens permet tenir dades meteorol\u00f2giques de les plantes fotovoltaiques. Aquest servei es comunica amb <code>plantmonitor</code> per a obtenir dades de les plantes. Es una API tipus SOAP i teniu la documentaci\u00f3 disponible aqui.</p> <p>Qu\u00e8 \u00e9s <code>plantmonitor</code>?</p> <p>Tots els scripts en aquest apartat fan refer\u00e8ncia al repositori de github <code>plantmonitor</code>. \u00c9s un projecte previ a <code>jardiner</code> que ens permet monitoritzar plantes fotovoltaiques quan l'obtenci\u00f3 de dades la gestionem nosaltres.</p> <p>A <code>plantmonitor</code> tenim un script que ens permet afegir plantes noves. Aquest script s'ha de cridar amb un fitxer yaml que contingui les dades de la planta.</p> <p>S'ha de crear la planta a la base de dades tant a la raspberrypi com a plantmonitor (no calen els dispositius, que els crea autom\u00e0ticament). Haureu d'afegir <code>plantlocation</code>, <code>plantparameters</code> i <code>moduleparameters</code>. Trobareu un exemple a plantmonitor</p> <p>Un cop teniu el fitxer yaml, per exemple <code>data/plant-nova.yaml</code>, podeu cridar l'script <code>addPlant.py</code> amb el seg\u00fcent comandament:</p> <pre><code>PLANTMONITOR_MODULE_SETTINGS='conf.settings.prod' python addPlant.py data/plant-asomada.yaml\n</code></pre> <p>Haureu de tenir un fitxer <code>.env.prod</code> amb les variables d'entorn necess\u00e0ries per a que l'script funcioni correctament. Mireu a la documentaci\u00f3 de plantmonitor per a m\u00e9s informaci\u00f3.</p> <p>De moment manualment cal afegir els registres de <code>plantestimatedmonthlyenergy</code>. L'any \u00e9s irrellevant. Si tenim hist\u00f2rics d'energia objectiu, els podeu afegir.</p> <pre><code>INSERT INTO\n public.plantestimatedmonthlyenergy(plantparameters, \"time\", monthly_target_energy_kwh)\nVALUES\n (33, '2022-01-01 00:00:00+01', 473630),\n (33, '2022-02-01 00:00:00+01', 453370),\n (33, '2022-03-01 00:00:00+01', 592040),\n (33, '2022-04-01 00:00:00+02', 617000),\n (33, '2022-05-01 00:00:00+02', 667210),\n (33, '2022-06-01 00:00:00+02', 648940),\n (33, '2022-07-01 00:00:00+02', 703030),\n (33, '2022-08-01 00:00:00+02', 644500),\n (33, '2022-09-01 00:00:00+02', 574580),\n (33, '2022-10-01 00:00:00+02', 524110),\n (33, '2022-11-01 00:00:00+01', 446490),\n (33, '2022-12-01 00:00:00+01', 442060);\n</code></pre> <ul> <li> <p>Executar l\u2019script d\u2019alba i posta per a generar totes les albes i postes dels propers 10 anys</p> <pre><code>python -m scripts.sun_events -p Alcolea -s 2021-12-13 -e 2021-12-14\n</code></pre> </li> <li> <p>Afegir les dades al diccionari de solargis (Veure com aqui). Quan deixi de ser hard-coded ja no caldr\u00e0 aquest pas.</p> </li> </ul>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#afegir-solargis","title":"Afegir planta al script de SolarGIS","text":"<p>S'ha de modificar el codi de plantmonitor per incloure la nova planta. Podeu trobar un exemple de modificacions github</p> <p>Amb la MR aprovada i fusionada, s'ha de fer <code>git pull</code> des de el servidor de producci\u00f3 i reiniciar el servei de plantmonitor.</p> <pre><code>ssh someone@somewhere.lan\nsource /home/&lt;someone&gt;/Envs/plantmonitor/bin/activate\ncd /home/&lt;someone&gt;/somenergia/plantmonitor\ngit pull\npython -m scripts.solargis --help\npython -m scripts.solargis [OPTIONS] DBAPI SOLARGIS_API_KEY FROM_DATE TO_DATE [PLANT_IDS]\nsudo supervisorctl restart plantmonitor\n</code></pre> <p>Aqui, <code>someone</code> \u00e9s el nom de l'usuari que t\u00e9 acc\u00e9s a <code>somewhere.lan</code>, i <code>PLANT_IDS</code> s\u00f3n els ids de les plantes que vau afegir a l'API de SolarGIS amb la PR anterior. Demaneu acc\u00e9s a <code>somewhere.lan</code> a l'equip de dades.</p> <p>La API de SolarGIS requereix un token d'acc\u00e9s i es crida remotament amb <code>supervisord</code>, amb codi al repositori de plantmonitor.</p> <p>L'API de SolarGIS \u00e9s SOAP</p> <p>L'API es del tipus SOAP i no REST. \u00c9s a dir, demana un XML amb les dades de la planta. Podeu trobar informaci\u00f3 sobre com cridar-la a la seva documentaci\u00f3 d'usuari.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#dades-requerides-per-aparells","title":"Dades requerides per aparells","text":""},{"location":"desenvolupadors/2023-08-28-alta_planta/#afegir-comptadors-a-lerp","title":"Afegir Comptadors a l'ERP","text":"<p>Les lectures a l'ERP s\u00f3n necessaries mentre metelogica faci servir les lectures de comptadors que plantmonitor copia de l'ERP. Tamb\u00e9 s\u00f3n necess\u00e0ries per al generationkwh. Per aix\u00f2 cal agafar les dades de Modelos contadores_inversores_SCADAS i afegir-les a l'erp Infrastructura -&gt; Registradors -&gt; tots els registradors.</p> <ul> <li>ip lan, port, porta d\u2019enlla\u00e7 i contrasenya</li> <li>tel\u00e8fon, si s'escau</li> </ul>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#serveis-de-somenergia-addicionals","title":"Serveis de SomEnergia addicionals","text":""},{"location":"desenvolupadors/2023-08-28-alta_planta/#nagios","title":"nagios","text":"<p>Preguntar a Gesti\u00f3 d'Actius si encara fan servir el nagios. Si si, afegir-la al nagios o modificar-la en cas de canvi d\u2019ip p\u00fablica</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#opendata","title":"opendata","text":"<p>Cal afegir la info de la nova planta a taula literal que es fa servir a <code>somenergia-opendata/som_opendata/queries/plantpower.sql</code>. Un cop aquesta info estigui a plantmonitor, l\u2019opendata podr\u00e0 agafar-la directament per sql i no caldr\u00e0 fer aquest pas.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#generationkwh","title":"generationkwh","text":"<p>Si la planta est\u00e0 inclosa al generation, \u00e9s important afegir-la a l\u2019erp abans de la mitja nit del dia de posada a producci\u00f3. Si no, cal descartar c\u00e0lculs de drets del generation per a que incloguin els resultats. Si, a m\u00e9s, els drets s\u2019han comen\u00e7at a gastar (15 dies de marge de facturaci\u00f3), cal reperfilar els nous drets amb la producci\u00f3 afegida perqu\u00e8 no superi els drets ja atorgats.</p> <p>La nova planta es crea fent servir l\u2019script a <code>somenergia-generationkwh/scripts/genkwh_plants.py</code></p> <p>Un exemple complert de com afegir una planta amb aquest script el podeu trobar a https://github.com/Som-Energia/somenergia-generationkwh/blob/master/scripts/genkwh_migrate_plantmeter_1_7_0_newplant.sh</p> <p>Es recomana provar primer a un ERP de testing o local, i, despr\u00e9s aplicar-ho a producci\u00f3.</p>"},{"location":"desenvolupadors/2023-08-28-alta_planta/#reperfilacio-de-dades","title":"Reperfilaci\u00f3 de dades","text":"<p>Un exemple d\u2019script de migraci\u00f3 en la que vam haver de reperfilar: https://github.com/Som-Energia/somenergia-generationkwh/blob/master/scripts/genkwh_migrate_plantmeter_1_7_2_fontivsolarfix.sh</p>"},{"location":"desenvolupadors/2024-01-11-incremental-dedup/","title":"Incremental Dedup","text":"<p>Exemple de com fer un incremental amb deduplicaci\u00f3 en dbt.</p> <pre><code>{{\n  config(\n    materialized = 'incremental',\n    unique_key = ['signal_uuid','ts'],\n    incremental_strategy = 'merge',\n    incremental_predicates = [\n      \"DBT_INTERNAL_DEST.queried_at &gt; dateadd(day, -1, current_date)\"\n    ]\n  )\n}}\n\nwhere\n    ts &lt; now() - interval '1 hour'  {#- select only freshly ingested rows #}\n\n    {% if is_incremental() -%}\n        and queried_at &gt; coalesce((select max(queried_at) from {{ this }}), '1900-01-01') and queried_at &gt; now() - interval '2 hour'\n    {%- endif %}\n</code></pre> source senyal ts valor queried_at energia_comptador 03:00 80 +1d 04:00 energia_comptador 03:00 null 04:00 potencia_inversor 03:00 50 +1d 04:00 potencia_inversor 03:00 50 04:00 <p>Son ara les 15:04. en la materialitzada tindrem</p> source senyal ts valor potencia_inversor 14:00 67 energia_comptador 14:00 null <p>o bien, la \u00faltima fila no hi ser\u00e0:</p> source senyal ts valor potencia_inversor 14:00 67"},{"location":"desenvolupadors/2024-01-11-incremental-dedup/#explicacio","title":"Explicaci\u00f3","text":"<p><code>where max(ts) = 14:00</code>:</p> source senyal ts valor potencia_inversor 14:00 67 energia_comptador 14:00 null <p><code>where max(ts) - 24h</code>:</p> source senyal ts valor queried_at energia_comptador 03:00 80 +1d 04:00 potencia_inversor 03:00 50 +1d 04:00 potencia_inversor 03:00 50 04:00 potencia_inversor 14:00 67 energia_comptador 14:00 null <p><code>unique (signal_uuid, ts)</code>:</p> source senyal ts valor queried_at energia_comptador 03:00 80 +1d 04:00"},{"location":"desenvolupadors/2024-01-11-incremental-dedup/#prova-practica","title":"prova pr\u00e0ctica","text":"<p>Abans d'executar l'incremental tenim aquest tres \u00faltims registres a materialized one hour late</p> group_name queried_at ts signal_code signal_device_type signal_device_uuid signal_frequency signal_id signal_is_virtual signal_last_ts signal_last_value signal_type signal_tz signal_unit signal_uuid signal_uuid_raw signal_value materialized_at SE_vallehermoso 2024-01-09 13:24:42.488123+01 2024-01-05 23:15:00+01 ce_eactexp meter 08bc8d88-4ea2-4ee9-b817-00e1f07debba 15 minutes 983894 false 2024-01-08 23:45:00+01 0 absolute Europe/Madrid kWh 646d1ec2-0ca2-4c22-9739-8161aafb224e 646d1ec2-0ca2-4c22-9739-8161aafb224e 0.0 2024-01-09 13:36:52.925381+01 SE_asomada 2024-01-09 13:24:42.488123+01 2024-01-05 23:00:00+01 s8102 meter c5ed9fab-e73c-40a5-acb3-113e22052fd6 5 minutes 1031060 false 2024-01-09 11:47:00+01 60.2 absolute Europe/Madrid V dd065f6a-4ded-41a8-98d3-ba239f9a2a47 dd065f6a-4ded-41a8-98d3-ba239f9a2a47 60.2 2024-01-09 13:36:52.925381+01 SE_tahal 2024-01-09 13:24:42.488123+01 2024-01-05 23:45:00+01 ce_ercapexp_er3 meter 5deb3780-02e2-4dcf-a6a7-de646991762c 15 minutes 983890 false 2024-01-08 23:45:00+01 0 absolute Europe/Madrid kVArh 31ae7d09-95db-447d-b5bf-358b056ef5bf 31ae7d09-95db-447d-b5bf-358b056ef5bf 0.0 2024-01-09 13:36:52.925381+01"},{"location":"desenvolupadors/2024-02-16-row-level-security/","title":"Row Level Security","text":""},{"location":"desenvolupadors/2024-02-16-row-level-security/#context","title":"Context","text":"<p>Tenim usuaris externs que necessiten mirar dades de plantes, per\u00f2 nom\u00e9s de les plantes que gestionen. Aix\u00f2 ho podem fer amb Row Level Security a Superset.</p> <p>El proc\u00e9s \u00e9s el seg\u00fcent:</p> <ol> <li>Crear un rol <code>Manteniment_&lt;nom empresa&gt;</code> si no existeix, pel cas de noves plantes.</li> <li>Afegir una regla Row Level Security     Pareu atenci\u00f3 al camp \"clause\", s'afegir\u00e0 com a condici\u00f3 where exclusiva (and) als datasets que seleccionem.</li> <li>Donar acc\u00e9s als charts d'un dashboard </li> <li>Afegir la o les usu\u00e0ries i assignar-los els rols [Gamma] i <code>[Manteniment_&lt;nom empresa&gt;]</code></li> </ol> <p>I ja ho tens. Ho he fet amb energes amb la clause <code>nom_planta in (noms plantes)</code></p>"},{"location":"desenvolupadors/2024-02-16-row-level-security/#decisions","title":"Decisions","text":"<p>Hem decidit a 02/2024 que no val la pena propagar l'empresa de manteniment en el pipe per a cobrir aquest use case, ja que no cal afegir 5m aquestes metadadades per a un tema de visualitzaci\u00f3 i permisos. Ho gestionem en la capa de visualitzaci\u00f3.</p> <p>Canvis d'empresa de manteniment</p> <p>Canvis d'empresa de manteniment s'hauran de fer al Superset (i a les metadades de la planta, per coher\u00e8ncia).</p>"},{"location":"desenvolupadors/2024-02-16-row-level-security/#referencies","title":"Refer\u00e8ncies","text":"<ul> <li>Issue #101 a gitlab</li> <li>Targeta Trello</li> </ul>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/","title":"Macrofase Jardiner 2023","text":"<p>Document de Roadmap</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#roadmap-overview","title":"Roadmap overview","text":""},{"location":"projecte/2023-06-03-macrofase%20roadmap/#flux-de-dades","title":"Flux de dades","text":"<pre><code>flowchart LR\n\nrPIs -- push 5'  --&gt; dw[db/plants]\nERP -- pull 20' \u00ba\\n meter data --&gt; dw\nSAT -- pull daily\\n irr/expected energy --&gt; dw\nMETEO &lt;-- pull daily\\n meter data +  irr/kWh forecast --&gt; dw\nPLANT -- pull 15'\\n devices data --&gt; dw\n\ndw -- dbt views --&gt; prod --&gt; alarms\nprod --&gt; alerts\nprod --&gt; datasets</code></pre>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-1","title":"Fita 1","text":"<p>Prioritat 1</p> <p>Aprox 1-2 fases</p> <p>Definition of Done (DoD): veure per tema</p> <p>Cost en mitjos dies de l'equip sencer entre par\u00e8ntesis (N)</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#dashboard-tecnics-de-plantes-critiques","title":"Dashboard t\u00e8cnics de plantes cr\u00edtiques","text":"<p>Pulir el dashboard de t\u00e8cnics per a Asomada i Llanillos.</p> <p>DoD: TODO</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#obtencio-de-dades-de-tots-els-equips-i-totes-les-plantes","title":"Obtenci\u00f3 de dades de tots els equips i totes les plantes","text":"<ul> <li> Definir estrat\u00e8gia d'obtenci\u00f3 de dades (remot/hardware/api's a plataformes...) (1)</li> <li> Coordinaci\u00f3 amb altres equips de la cooperativa per veure altres alternatives (6)</li> <li> Proves pilot amb alg\u00fan prove\u00efdor (8)</li> <li>[-] Analisi de prove\u00efdors/alternatives i selecci\u00f3 de partner per externalitzar l'obtenci\u00f3 de dades dels inversors i sondes (2)</li> <li> <p>[-] Obtenci\u00f3 de dades tots els comptadors per IP.</p> </li> <li> <p> Adaptaci\u00f3 a frequ\u00e8ncia quarthoraria. (3)</p> </li> <li> <p>[-] Suport a la integraci\u00f3 de prova pilot (6)</p> </li> <li>Falta saber com es diferencien les plantes</li> </ul> <p>DoD:</p> <ul> <li> Els equips mencionats en el pipe</li> <li> Dset integrat al pipe</li> </ul>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#introduccio-al-jardiner","title":"Introducci\u00f3 al jardiner","text":"<p>Estat del codi i rep\u00e0s de l'estructura. Documentaci\u00f3 per devs.</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#dt-obt-i-fast-lane","title":"[DT] OBT i fast-lane","text":"<p>Crear la obt cincminutal incremental i/o el fast-lane cincminutal i la obt di\u00e0ria.</p> <p>Crear el live per late arriving facts de comptadors i apis.</p> <p>En funcionament normal s\u00f3n delays de m\u00e0xim un dia. Amb incid\u00e8ncia poden ser 1-2 mesos m\u00e0xim. I en casos excepcionals, molt m\u00e9s (candidat a full-refresh manual o alguna altra cosa)</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#aterracio-de-tot-plegat","title":"Aterraci\u00f3 de tot plegat","text":"<ul> <li> Intro per devs</li> <li>M\u00e9s doc?</li> <li> Afegit la prove\u00efdora de dades al pipe</li> <li>Decidir com (multisource/sol)</li> <li> Refer el pipe (fast+slow)</li> <li>Que no tardi 30s</li> <li>DBT standards</li> <li> Definir el dashboard de t\u00e8cnics</li> <li>Volem fer servir redash?</li> <li>~Parlar amb GA per si volen el Dashboard diferent al actual~ El volen tal com s\u00f3n</li> <li> Dashboard tecnics Exiom amb Asomada</li> <li> Dashboard tecnics Exiom amb Llanillos (source original \u00e9s dset)</li> <li> Deute t\u00e8cnic Dev</li> <li>CDD</li> <li>Private doc github project</li> </ul>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-2-dashboard-overview-plantes","title":"Fita 2: Dashboard Overview plantes","text":"<p>Prioritat 4</p> <p>Disseny d'un Dashboard amb un llistat de totes les plantes amb els principals indicadors (mesures en temps real i acumulades i resum alarmes). Pendent fer una proposta per part de GA. Des d'aquest dashboard s'ha de poder accedir al Dashboard de cada planta per obtenir informaci\u00f3 detallada. Esborrany inicial falta versi\u00f3 actualitzada. (6)</p> <p>Implementaci\u00f3 (9)</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-3-dashboard-planta","title":"Fita 3: Dashboard planta","text":"<p>Prioritat 5</p> <p>Definir versi\u00f3 revisada del Dashboard de planta per a totes les plantes: Unifilar din\u00e0mic, dades fixes i reempla\u00e7ar alarmes, millorar la velociatat i treure el dataset de sota, afegir solargis + coses que puguin sortir despr\u00e9s (3)</p> <p>Implementar versi\u00f3 revisada del Dashboard de planta per a totes les plantes: Unifilar din\u00e0mic, dades fixes i reempla\u00e7ar alarmes, millorar la velocitat i treure el dataset de sota, afegir solargis + coses que puguin sortir despr\u00e9s (3)</p> <p>Dashboard Ringsted per plantes -- particularitats (4)</p> <p>Dashboard Gasdtrup -- particularitats (4)</p> <p>Dashboard de planta t\u00edpica (Alcolea, etc) (0)</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-4-dashboard-tecnics","title":"Fita 4: Dashboard t\u00e8cnics","text":"<p>Prioritat 6</p> <p>Definir la versi\u00f3 final amb grafiques de Solar Gis, Alarmes i pot ser alarmes. Pendent fer una revisi\u00f3 de les funcionalitats per part de GA. Incloure un dashboard per cadascuna de les empreses de manteniment. Al dashboard unificat d'alarmes estat actual afegir des de quan est\u00e0 activada l'alarma</p> <p>Implementar la versi\u00f3 final amb grafiques de Solar Gis, Alarmes i pot ser alarmes. Pendent fer una revisi\u00f3 de les funcionalitats per part de GA. Incloure un dashboard per cadascuna de les empreses de manteniment</p> <p>Fer el Dashboard per a 8 empreses instal\u00b7ladores. Haur\u00edem de passar a Superset que t\u00e9 una millor gesti\u00f3 d'usuaris?</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-5-dashboard-ineco","title":"Fita 5: Dashboard INECO","text":"<p>Prioritat 7</p> <p>Per definir</p>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-6-noves-queries","title":"Fita 6: Noves queries","text":"<p>Prioritat 8</p> <ul> <li> Query: Curves HMCIL + lectures comptador (reclamacions)</li> <li> Query: Curves HMCIL + previsi\u00f3 (seguiment)</li> <li> Alarma strings per comparaci\u00f3 en plantes grans &gt;1MW</li> </ul>"},{"location":"projecte/2023-06-03-macrofase%20roadmap/#fita-7-dashboard-gurb","title":"Fita 7: Dashboard GURB","text":"<p>Prioritat 9</p>"},{"location":"projecte/2023-06-03-overview/","title":"Overview del projecte per a usuaris","text":"<p>Descripci\u00f3 del projecte des del punt de vista de l'usuari</p>"},{"location":"projecte/2023-06-03-overview/#context-de-naixement","title":"Context de naixement","text":"<ul> <li>A quin objectiu respon? Guanyar autonomia dins del mercat el\u00e8ctric.</li> <li>Context: per qu\u00e8 \u00e9s important? per guanyar en efici\u00e8ncia i optimitzar la producci\u00f3 (problema)</li> <li>Intenci\u00f3: on volem arribar? tenir un sistema de monitoritzaci\u00f3 unificat per a totes les plantes de producci\u00f3 (soluci\u00f3)</li> <li>Criteris d\u2019\u00e8xit: com mesurar progr\u00e9s i \u00e8xit?</li> <li>N\u00famero de plantes que poden gestionar per persona (20-25 plantes/persona)</li> <li>Agilitat en detectar incid\u00e8ncies (1.800 \u20ac/dia per p\u00e8rdues de producci\u00f3 seria el cas m\u00e9s extrem per una planta de 5MW. Si triguem una setmana en detectar-ho serien 12.600 \u20ac)</li> </ul>"},{"location":"projecte/2023-06-03-overview/#peces","title":"Peces","text":"<ul> <li>Usuaris: T\u00e8cnics de planta, Gesti\u00f3 d'Actius, Altres \u00e0mbits de l'ET, IT</li> <li>Altres Rols: Prove\u00efdors d'internet</li> <li>Interf\u00edcies de contacte:</li> <li>redash</li> <li>Helpscout/notificacions</li> <li>erp</li> </ul>"}]}